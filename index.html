<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rhodes Burgers - Menú</title>
  <link rel="icon" href="images/logo.png" />
  <style>
    :root{ --primary:#2ecc71; --text:#111; --muted:#666; --bg:#f6f6f6; --card:#fff; --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.08) }
    *{ box-sizing:border-box }
    html,body{ margin:0; background:var(--bg); color:var(--text); font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif }
    body::before{ content:""; position:fixed; inset:0; background:url("images/logo.png") center 120px/320px no-repeat; opacity:.06; pointer-events:none; z-index:0; filter:grayscale(100%) }
    header{ position:sticky; top:0; z-index:10; background:#fff; box-shadow:0 2px 12px rgba(0,0,0,.06) }
    .topbar{ max-width:1000px; margin:0 auto; padding:10px 12px; display:flex; align-items:center; gap:12px }
    .brand img{ width:40px; height:40px; border-radius:10px; background:#fff; object-fit:contain }
    .spacer{ flex:1 }
    .btn{ display:inline-flex; align-items:center; gap:10px; border:2px solid var(--primary); padding:10px 16px; border-radius:999px; color:var(--primary); background:#fff; font-weight:700; text-decoration:none; cursor:pointer }
    .btn.primary{ background:var(--primary); color:#fff }
    .btn.ghost{ border-color:#e7e7e7; color:#333 }
    .container{ max-width:1000px; margin:24px auto; padding:0 12px }
    h1{ font-size:34px; margin:14px 4px 18px }
    h2{ font-size:26px; margin:24px 4px 14px }
    h3{ font-size:18px; margin:8px 0 6px }
    p{ margin:6px 0; color:var(--muted) }
    .grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(230px,1fr)); gap:16px }
    .card{ background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:0; overflow:hidden; display:flex; flex-direction:column }
    .card img{ width:100%; height:160px; object-fit:cover; background:#f0f0f0 }
    .card .content{ padding:12px }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:8px }
    .price{ font-weight:800 }
    .actions{ display:flex; gap:8px; flex-wrap:wrap }
    .drawer{ position:fixed; top:0; right:-460px; width:460px; max-width:92vw; height:100vh; background:#fff; box-shadow:-8px 0 30px rgba(0,0,0,.18); transition:right .25s; z-index:30; display:flex; flex-direction:column }
    .drawer.open{ right:0 }
    .drawer header{ padding:14px 16px; box-shadow:0 2px 12px rgba(0,0,0,.06) }
    .drawer .body{ padding:14px 16px; overflow:auto; flex:1 }
    .item{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding:8px 0; border-bottom:1px solid #efefef }
    .total{ display:flex; align-items:center; justify-content:space-between; font-weight:800; font-size:18px; margin-top:10px }
    .close{ position:absolute; top:10px; right:10px; width:38px; height:38px; border-radius:999px; border:1px solid #eee; background:#fff; font-weight:900; cursor:pointer }
    .muted{ color:var(--muted); font-size:14px }
    .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.25); display:none; align-items:center; justify-content:center; z-index:40 }
    .overlay.open{ display:flex }
    .modal{ background:#fff; border-radius:20px; box-shadow:var(--shadow); width:520px; max-width:92vw; padding:16px }
    .modal h3{ margin:0 0 8px }
    .rowx{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin:10px 0 }
    .qtybox{ display:inline-flex; align-items:center; gap:10px; border:1px solid #e7e7e7; border-radius:999px; padding:6px 10px }
    .qtybox button{ width:28px; height:28px; border:1px solid #e5e5e5; background:#fff; border-radius:999px; font-weight:900; cursor:pointer }
    textarea{ width:100%; min-height:70px; padding:10px; border:1px solid #e7e7e7; border-radius:12px }
  </style>
</head>
<body>
<header>
  <div class="topbar">
    <a href="index.html" class="brand"><img src="images/logo.png" onerror="this.src='images/logo.jpg'" alt="Rhodes Burgers"></a>
    <div class="spacer"></div>
    <button class="btn ghost" id="btnContacto">Contacto</button>
    <button class="btn primary" id="btnCart">Ver pedido</button>
  </div>
</header>

<main>
  <div class="container">
    <h1>Menú</h1>
    <h2>Hamburguesas</h2>
    <div id="burgersGrid" class="grid"></div>
    <h2>Bebidas</h2>
    <div id="drinksGrid" class="grid"></div>
  </div>
</main>

<aside class="drawer" id="drawer">
  <header>
    <strong>Tu pedido</strong>
    <button class="close" id="closeDrawer">✕</button>
  </header>
  <div class="body">
    <div id="cartItems"></div>
    <div class="total"><span>Total</span><span id="cartTotal">$0</span></div>
    <div style="margin-top:12px; display:flex; gap:10px">
      <button class="btn ghost" id="btnVaciar">Vaciar</button>
      <button class="btn primary" id="btnIrPagar">Ir a pagar</button>
    </div>
    <p class="muted" style="margin-top:8px">Las papas se eligen en la pantalla de pago.</p>
  </div>
</aside>

<div class="overlay" id="overlay">
  <div class="modal">
    <h3 id="modTitle">Personalizar</h3>
    <div class="rowx">
      <div>Cantidad</div>
      <div class="qtybox">
        <button id="qtyDec">-</button><span id="qtyVal">1</span><button id="qtyInc">+</button>
      </div>
    </div>
    <div id="extrasWrap">
      <div class="rowx" id="rowPatties" style="display:none">
        <div>Medallones extra <span class="muted">(máx. +2)</span></div>
        <div class="qtybox">
          <button id="patDec">-</button><span id="patVal">0</span><button id="patInc">+</button>
        </div>
      </div>
      <div class="rowx" id="rowCheddar" style="display:none">
        <div>Fetas de cheddar extra <span class="muted" id="cheHint">(máx. +3)</span></div>
        <div class="qtybox">
          <button id="cheDec">-</button><span id="cheVal">0</span><button id="cheInc">+</button>
        </div>
      </div>
      <div class="muted" id="noExtras" style="display:none">Este producto no admite extras.</div>
    </div>
    <div class="rowx" style="align-items:flex-start; flex-direction:column">
      <label>Notas (opcional)</label>
      <textarea id="notes" placeholder="Sin cebolla, extra salsa, etc."></textarea>
    </div>
    <div class="rowx" style="justify-content:flex-end">
      <button class="btn ghost" id="btnCancel">Cancelar</button>
      <button class="btn primary" id="btnAdd">Agregar al carrito</button>
    </div>
  </div>
</div>

<script>
const EXTRA_PRICE_PATTY=0,EXTRA_PRICE_CHEDDAR=0;
const BURGERS=[/* … tus burgers, igual que antes … */];
const DRINKS=[/* … tus bebidas, igual que antes … */];
// (Para ahorrar espacio aquí, usa las mismas listas del mensaje anterior.)
const FALLBACK_IMG="images/logo.png", CART_KEY="rhodes_cart_v3";
const $=s=>document.querySelector(s);
const money=n=>n.toLocaleString("es-AR",{style:"currency",currency:"ARS",maximumFractionDigits:0});

let cart=loadCart(); // {burger:{},drink:{},fries:null}
function loadCart(){ try{return JSON.parse(localStorage.getItem(CART_KEY))||{burger:{},drink:{},fries:null}}catch{return{burger:{},drink:{},fries:null}}}
function saveCart(){ try{localStorage.setItem(CART_KEY,JSON.stringify(cart))}catch{} }
function cartCount(){ let n=0; for(const b of Object.values(cart.burger)) n+=b.qty; for(const d of Object.values(cart.drink)) n+=d.qty; return n; }
function calcTotal(){ let t=0; for(const b of Object.values(cart.burger)){const base=b.item?.price||0; const ex=(b.extras?.patty||0)*EXTRA_PRICE_PATTY+(b.extras?.cheddar||0)*EXTRA_PRICE_CHEDDAR; t+=(base+ex)*b.qty} for(const d of Object.values(cart.drink)) t+=(d.item?.price||0)*d.qty; return t; }

const gridBurgers=$("#burgersGrid"), gridDrinks=$("#drinksGrid");
function card(item,type){
  const el=document.createElement("div");
  el.className="card";
  el.innerHTML=`<img src="${encodeURI(item.img)}" alt="${item.name}" onerror="this.onerror=null;this.src='${FALLBACK_IMG}'"><div class="content"><h3>${item.name}</h3>${item.desc?`<p class="muted" style="margin:4px 0 0">${item.desc}</p>`:""}<div class="row"><span class="price">${money(item.price)}</span><div class="actions">${type==="drink"?`<button class="btn" data-add>Agregar</button>`:`<button class="btn" data-quick>Añadir</button><button class="btn" data-custom>Personalizar</button>`}</div></div></div>`;
  if(type==="drink"){ el.querySelector("[data-add]").onclick=()=>addDrink(item) } else { el.querySelector("[data-quick]").onclick=()=>addBurger(item); el.querySelector("[data-custom]").onclick=()=>openCustomize(item); }
  return el;
}
function mount(){
  gridBurgers.innerHTML=""; /* agrega tus burgers */ 
  gridDrinks.innerHTML="";  /* agrega tus bebidas */
  renderCart();
}
function addBurger(item){ const b=cart.burger||(cart.burger={}); if(!b[item.id]) b[item.id]={qty:0,item,extras:{patty:0,cheddar:0}}; b[item.id].qty++; saveCart(); renderCart(); openDrawer(); }
function addDrink(item){ const d=cart.drink||(cart.drink={}); if(!d[item.id]) d[item.id]={qty:0,item}; d[item.id].qty++; saveCart(); renderCart(); openDrawer(); }

const drawer=$("#drawer"), cartItems=$("#cartItems"), cartTotal=$("#cartTotal");
function renderCart(){
  cartItems.innerHTML="";
  for(const o of Object.values(cart.burger)){
    const extra=[]; if(o.extras?.patty) extra.push(`+${o.extras.patty} medallón(es)`); if(o.extras?.cheddar) extra.push(`+${o.extras.cheddar} cheddar`);
    const unit=o.item.price+(o.extras?.patty||0)*EXTRA_PRICE_PATTY+(o.extras?.cheddar||0)*EXTRA_PRICE_CHEDDAR;
    cartItems.innerHTML+=`<div class="item"><div><strong>${o.item.name}</strong>${extra.length?`<div class="muted">${extra.join(" · ")}</div>`:""}${o.notes?`<div class="muted">Notas: ${o.notes}</div>`:""}</div><div style="display:flex;align-items:center;gap:10px"><button class="btn ghost" onclick="chg('burger','${o.item.id}',-1)">-</button><span>${o.qty}</span><button class="btn ghost" onclick="chg('burger','${o.item.id}',1)">+</button><span>${money(unit*o.qty)}</span></div></div>`;
  }
  for(const o of Object.values(cart.drink)){
    cartItems.innerHTML+=`<div class="item"><div><strong>${o.item.name}</strong></div><div style="display:flex;align-items:center;gap:10px"><button class="btn ghost" onclick="chg('drink','${o.item.id}',-1)">-</button><span>${o.qty}</span><button class="btn ghost" onclick="chg('drink','${o.item.id}',1)">+</button><span>${money(o.item.price*o.qty)}</span></div></div>`;
  }
  cartTotal.textContent=money(calcTotal());
  document.getElementById("btnCart").innerHTML=`Ver pedido <span class="muted">(${cartCount()})</span>`;
}
window.chg=function(type,id,delta){ const b=cart[type]; if(!b) return; const cur=b[id]?.qty||0; const next=Math.max(0,cur+delta); if(next===0) delete b[id]; else b[id].qty=next; saveCart(); renderCart(); }

const overlay=$("#overlay"), modTitle=$("#modTitle"); const qtyVal=$("#qtyVal"),qtyInc=$("#qtyInc"),qtyDec=$("#qtyDec"); const rowPatties=$("#rowPatties"),rowCheddar=$("#rowCheddar"),noExtras=$("#noExtras"),cheHint=$("#cheHint"); const patVal=$("#patVal"),patInc=$("#patInc"),patDec=$("#patDec"); const cheVal=$("#cheVal"),cheInc=$("#cheInc"),cheDec=$("#cheDec"); const notes=$("#notes"),btnAdd=$("#btnAdd"),btnCancel=$("#btnCancel");
let currentItem=null;
function openCustomize(item){ currentItem=item; modTitle.textContent="Personalizar: "+item.name; qtyVal.textContent="1"; notes.value=""; patVal.textContent="0"; cheVal.textContent="0"; if(item.kind==="double"){rowPatties.style.display="flex";rowCheddar.style.display="flex";cheHint.textContent="(máx. +3)";noExtras.style.display="none"} else if(item.kind==="chicken"){rowPatties.style.display="none";rowCheddar.style.display="flex";cheHint.textContent="(máx. +3)";noExtras.style.display="none"} else {rowPatties.style.display="none";rowCheddar.style.display="none";noExtras.style.display="block"} overlay.classList.add("open"); }
function closeCustomize(){ overlay.classList.remove("open") }
qtyInc.onclick=()=>qtyVal.textContent=String(Math.min(99,(+qtyVal.textContent||1)+1));
qtyDec.onclick=()=>qtyVal.textContent=String(Math.max(1,(+qtyVal.textContent||1)-1));
patInc.onclick=()=>{ if(+patVal.textContent<2) patVal.textContent=(+patVal.textContent)+1; };
patDec.onclick=()=>{ if(+patVal.textContent>0) patVal.textContent=(+patVal.textContent)-1; };
cheInc.onclick=()=>{ if(+cheVal.textContent<3) cheVal.textContent=(+cheVal.textContent)+1; };
cheDec.onclick=()=>{ if(+cheVal.textContent>0) cheVal.textContent=(+cheVal.textContent)-1; };
btnCancel.onclick=closeCustomize;
btnAdd.onclick=()=>{ const qty=+qtyVal.textContent||1; const extras={patty:0,cheddar:0}; if(currentItem.kind==="double"){extras.patty=+patVal.textContent||0; extras.cheddar=+cheVal.textContent||0} else if(currentItem.kind==="chicken"){extras.patty=0; extras.cheddar=+cheVal.textContent||0} const txt=notes.value.trim(); const b=cart.burger||(cart.burger={}); const prev=b[currentItem.id]; if(prev){ prev.qty+=qty; prev.extras={patty:Math.max(prev.extras?.patty||0,extras.patty),cheddar:Math.max(prev.extras?.cheddar||0,extras.cheddar)}; if(txt) prev.notes=txt } else { b[currentItem.id]={qty,item:currentItem,extras,...(txt?{notes:txt}:{})} } saveCart(); renderCart(); closeCustomize(); openDrawer(); };

function openDrawer(){ drawer.classList.add("open") }
function closeDrawer(){ drawer.classList.remove("open") }
document.getElementById("btnCart").onclick=openDrawer;
document.getElementById("closeDrawer").onclick=closeDrawer;
document.getElementById("btnVaciar").onclick=()=>{ cart={burger:{},drink:{},fries:null}; saveCart(); renderCart(); };
document.getElementById("btnContacto").onclick=()=>location.href="contacto.html";

// *** A Pagar: guarda en storages y COOKIE + URL backup
document.getElementById("btnIrPagar").onclick=()=>{
  try{ localStorage.setItem(CART_KEY,JSON.stringify(cart)); sessionStorage.setItem(CART_KEY,JSON.stringify(cart)); }catch{}
  try{
    const raw=JSON.stringify(cart);
    const b64=btoa(raw);
    document.cookie=`cart=${b64}; Max-Age=1800; Path=/; SameSite=Lax`;
    location.href=`pedido_cliente.html?cart=${encodeURIComponent(b64)}`;
  }catch{
    location.href="pedido_cliente.html";
  }
};

mount();
</script>
</body>
</html>
