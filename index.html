<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rhodes Burgers - MenÃº</title>
  <link rel="icon" href="images/logo.png" />
  <style>
    :root{ --primary:#2ecc71; --text:#111; --muted:#666; --bg:#f6f6f6; --card:#fff; --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.08) }
    *{ box-sizing:border-box }
    html,body{ margin:0; background:var(--bg); color:var(--text); font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif }
    body::before{ content:""; position:fixed; inset:0; background:url("images/logo.png") center 120px/320px no-repeat; opacity:.06; pointer-events:none; z-index:0; filter:grayscale(100%) }
    header{ position:sticky; top:0; z-index:10; background:#fff; box-shadow:0 2px 12px rgba(0,0,0,.06) }
    .topbar{ max-width:1000px; margin:0 auto; padding:10px 12px; display:flex; align-items:center; gap:12px }
    .brand img{ width:40px; height:40px; border-radius:10px; background:#fff; object-fit:contain }
    .spacer{ flex:1 }
    .btn{ display:inline-flex; align-items:center; gap:10px; border:2px solid var(--primary); padding:10px 16px; border-radius:999px; color:var(--primary); background:#fff; font-weight:700; text-decoration:none; cursor:pointer }
    .btn.primary{ background:var(--primary); color:#fff }
    .cart-badge{ min-width:26px; height:26px; display:inline-flex; align-items:center; justify-content:center; background:#fff; color:var(--primary); border-radius:999px; padding:0 8px; font-weight:800 }
    .container{ max-width:1000px; margin:24px auto; padding:0 12px }
    h1{ font-size:42px; margin:14px 4px 24px }
    h2{ font-size:32px; margin:28px 4px 16px }
    h3{ font-size:20px; margin:10px 0 6px }
    p{ margin:6px 0; color:var(--muted) }
    .grid{ display:grid; gap:16px; grid-template-columns:repeat(auto-fill,minmax(230px,1fr)) }
    .card{ background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; display:flex; flex-direction:column }
    .card img{ width:100%; height:160px; object-fit:cover; background:#f0f0f0 }
    .card .content{ padding:12px }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:8px }
    .price{ font-weight:800 }
    .actions{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px }
    .pill{ display:inline-flex; align-items:center; gap:8px; border:1px solid #e7e7e7; border-radius:999px; padding:8px 12px; margin-right:8px }
    .box{ background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding:18px; margin:8px 0 16px }
    .help{ color:var(--muted); font-size:15px }
    .drawer{ position:fixed; top:0; right:-460px; width:460px; max-width:92vw; height:100vh; background:#fff; box-shadow:-8px 0 30px rgba(0,0,0,.18); transition:right .25s ease; z-index:30; display:flex; flex-direction:column }
    .drawer.open{ right:0 }
    .drawer header{ padding:14px 16px; box-shadow:0 2px 12px rgba(0,0,0,.06) }
    .drawer .body{ padding:14px 16px; overflow:auto; flex:1 }
    .divider{ height:1px; background:#eee; margin:12px 0 }
    .item{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:8px 0 }
    .total{ display:flex; align-items:center; justify-content:space-between; font-size:18px; font-weight:800 }
    .close{ position:absolute; top:10px; right:10px; width:38px; height:38px; border-radius:999px; border:1px solid #eee; background:#fff; font-weight:900 }
    /* Modal */
    .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.25); display:none; align-items:center; justify-content:center; z-index:40 }
    .overlay.open{ display:flex }
    .modal{ background:#fff; border-radius:20px; box-shadow:var(--shadow); width:520px; max-width:92vw; padding:18px }
    .modal h3{ margin-top:0 }
    .qtybox{ display:inline-flex; align-items:center; gap:10px; border:1px solid #e7e7e7; border-radius:999px; padding:6px 10px }
    .qtybox button{ width:28px; height:28px; border:1px solid #e5e5e5; background:#fff; border-radius:999px; font-weight:900 }
    textarea{ width:100%; min-height:70px; padding:10px; border:1px solid #e7e7e7; border-radius:12px }
  </style>
</head>
<body>
  <header>
    <div class="topbar">
      <a href="#" class="brand"><img src="images/logo.png" alt="Rhodes Burgers"></a>
      <div class="spacer"></div>
      <a class="btn" id="btnContacto">ðŸ“ž Contacto</a>
      <a class="btn primary" id="btnCarrito">ðŸ›’ Carrito <span class="cart-badge" id="cartCount">0</span></a>
    </div>
  </header>

  <main>
    <div class="container">
      <h1>MenÃº</h1>

      <h2>Hamburguesas</h2>
      <div id="burgersGrid" class="grid"></div>

      <h2>Papas fritas <span class="muted">(obligatorio)</span></h2>
      <div class="box">
        <label class="pill"><input type="radio" name="papas" value="con_sazon"> Con sazÃ³n <span class="muted">(sin costo)</span></label>
        <label class="pill"><input type="radio" name="papas" value="sin_sazon"> Sin sazonar <span class="muted">(sin costo)</span></label>
        <p class="help">ElegÃ­ una opciÃ³n. La agregamos a tu pedido sin costo.</p>
      </div>

      <h2>Bebidas</h2>
      <div id="drinksGrid" class="grid"></div>
    </div>
  </main>

  <!-- Drawer Carrito -->
  <aside class="drawer" id="drawer">
    <header>
      <strong>Tu pedido</strong>
      <button class="close" id="closeDrawer">âœ•</button>
    </header>
    <div class="body">
      <div id="cartItems"></div>
      <div class="divider"></div>
      <div class="item"><span>Papas (obligatorio)</span><span id="papasSummary" class="muted">Sin elegir</span></div>
      <div class="divider"></div>
      <div class="total"><span>Total</span><span id="cartTotal">$0</span></div>
      <div style="margin-top:16px; display:flex; gap:10px; flex-wrap:wrap">
        <button class="btn" id="btnVaciar">Vaciar</button>
        <button class="btn primary" id="btnFinalizar">Finalizar pedido</button>
      </div>
      <p class="muted" style="margin-top:10px">Vas a completar tus datos en la siguiente pantalla.</p>
    </div>
  </aside>

  <!-- Modal Personalizar -->
  <div class="overlay" id="overlay">
    <div class="modal">
      <h3 id="modTitle">Personalizar</h3>
      <div class="row" style="margin-top:12px">
        <span>Cantidad</span>
        <div class="qtybox" style="margin-left:10px">
          <button id="modDec">-</button>
          <span id="modQty">1</span>
          <button id="modInc">+</button>
        </div>
      </div>
      <div class="row" style="margin-top:12px">
        <label style="width:100%">Notas (opcional)
          <textarea id="modNotes" placeholder="Sin cebolla, extra cheddar, etc."></textarea>
        </label>
      </div>
      <div class="row" style="justify-content:flex-end; gap:10px; margin-top:14px">
        <button class="btn" id="modCancel">Cancelar</button>
        <button class="btn primary" id="modAdd">Agregar al carrito</button>
      </div>
    </div>
  </div>

  <script>
    /*************** DATOS ***************/
    const BURGERS = [
      { id:"bigjohn_simple",  name:"Big John Simple",     price:7800, img:"images/Big John Simple.jpg",   desc:"Simple medallÃ³n, cheddar, pepinos" },
      { id:"bigjohn_doble",   name:"Big John Doble",      price:9500, img:"images/Big John Doble.jpg",    desc:"Doble medallÃ³n, cheddar, pepinos" },
      { id:"burguesa_simple", name:"Burguesa Simple",     price:6900, img:"images/Burguesa Simple.jpg",   desc:"Carne, cheddar" },
      { id:"burguesa_doble",  name:"Burguesa Doble",      price:8700, img:"images/Burguesa Doble.jpg",    desc:"Doble carne, cheddar" },
      { id:"cheesebacon_spl", name:"CheeseBacon Simple",  price:7900, img:"images/CheeseBacon Simple.jpg",desc:"Carne, cheddar y bacon" },
      { id:"cheesebacon_dbl", name:"CheeseBacon Doble",   price:9300, img:"images/CheeseBacon Doble.jpg", desc:"Doble carne, cheddar y bacon" },
      { id:"cheese_simple",   name:"Cheeseburger Simple", price:7200, img:"images/cheeseburger simple.jpg",desc:"Carne con cheddar" },
      { id:"cheese_doble",    name:"Cheeseburger Doble",  price:8900, img:"images/cheeseburger doble.jpg",desc:"Doble carne con doble cheddar" },
      { id:"rhodes_simple",   name:"Rhodes Simple",       price:7600, img:"images/Rhodes Simple.jpg",     desc:"Carne, cheddar, cebolla" },
      { id:"rhodes_doble",    name:"Rhodes Doble",        price:9200, img:"images/Rhodes Doble.jpg",      desc:"Doble carne, cheddar, cebolla" },
      { id:"morgan_simple",   name:"Morgan Simple",       price:0,    img:"images/Morgan Simple.jpg",     desc:"TODO desc" },
      { id:"morgan_doble",    name:"Morgan Doble",        price:0,    img:"images/Morgan Doble.jpg",      desc:"TODO desc" },
      { id:"pollo_crispy",    name:"Pollo Crispy",        price:0,    img:"images/Pollo crispy.jpg",      desc:"TODO desc" }
    ];
    const DRINKS = [
      { id:"coca_org",  name:"Coca-Cola Original 500ml", price:0, img:"images/coca cola original.jpg" },
      { id:"coca_zero", name:"Coca-Cola Zero 500ml",     price:0, img:"images/coca cola zero.jpg" },
      { id:"sprite",    name:"Sprite 500ml",             price:0, img:"images/sprite.jpg" },
      { id:"aqu_pear",  name:"Aquarius Limonada 500ml",  price:0, img:"images/aquarius pera.jpg" },
      { id:"aqu_pome",  name:"Aquarius Pomelo 500ml",    price:0, img:"images/aquarius pomelo.jpg" }
    ];
    const FALLBACK_IMG = "images/logo.png";
    const CART_KEY = "rhodes_cart_v3"; // clave del carrito en localStorage

    /*************** UTIL ***************/
    const $ = s => document.querySelector(s);
    const money = n => n.toLocaleString("es-AR",{style:"currency",currency:"ARS",maximumFractionDigits:0});

    /*************** ESTADO ***************/
    let cart = loadCart(); // {burger:{}, drink:{}, fries:null}

    function loadCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY)) || { burger:{}, drink:{}, fries:null }; }catch{ return { burger:{}, drink:{}, fries:null }; } }
    function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); }

    function cartCount(){ let n=0; for(const b of Object.values(cart.burger)) n+=b.qty; for(const d of Object.values(cart.drink)) n+=d.qty; return n; }
    function calcTotal(){ let t=0; for(const b of Object.values(cart.burger)) t+= (b.item?.price||0)*b.qty; for(const d of Object.values(cart.drink)) t+= (d.item?.price||0)*d.qty; return t; }
    function findItem(type,id){ const list = type==="burger"?BURGERS:DRINKS; return list.find(x=>x.id===id); }

    /*************** RENDER ***************/
    const gridBurgers = $("#burgersGrid");
    const gridDrinks  = $("#drinksGrid");
    const cartCountEl = $("#cartCount");
    const cartItemsEl = $("#cartItems");
    const cartTotalEl = $("#cartTotal");
    const papasSummaryEl = $("#papasSummary");
    const drawer = $("#drawer");

    function renderCard(item,type){
      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`
        <img src="${encodeURI(item.img)}" alt="${item.name}" onerror="this.onerror=null;this.src='${FALLBACK_IMG}'">
        <div class="content">
          <h3>${item.name}</h3>
          ${item.desc?`<p>${item.desc}</p>`:""}
          <div class="row">
            <span class="price">${money(item.price)}</span>
            <div class="actions">
              ${type==="drink"
                ? `<button class="btn" data-add>Agregar</button>`
                : `<button class="btn" data-personalizar>Personalizar</button>`}
            </div>
          </div>
        </div>`;
      if(type==="drink"){
        card.querySelector("[data-add]").onclick = ()=> {
          const bucket = cart.drink || (cart.drink={});
          const prev = bucket[item.id]?.qty || 0;
          bucket[item.id] = { qty: prev+1, item };
          saveCart(); sync(); openDrawer();
        };
      }else{
        card.querySelector("[data-personalizar]").onclick = ()=> openCustomize(type,item);
      }
      return card;
    }

    function mount(){
      gridBurgers.innerHTML=""; BURGERS.forEach(b=>gridBurgers.appendChild(renderCard(b,"burger")));
      gridDrinks.innerHTML="";  DRINKS.forEach(d=>gridDrinks.appendChild(renderCard(d,"drink")));
      sync();
    }

    function rowItem(type,obj){
      return `
        <div class="item">
          <div>
            <div><strong>${obj.item.name}</strong>${obj.notes?`<div class="muted">Notas: ${obj.notes}</div>`:""}</div>
            <div class="muted">${money(obj.item.price)} x ${obj.qty}</div>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn" onclick="addToCart('${type}','${obj.item.id}',-1)">-</button>
            <span>${obj.qty}</span>
            <button class="btn" onclick="addToCart('${type}','${obj.item.id}',1)">+</button>
          </div>
        </div>`;
    }

    function sync(){
      cartCountEl.textContent = cartCount();
      const rows=[];
      for(const obj of Object.values(cart.burger)) rows.push(rowItem("burger",obj));
      for(const obj of Object.values(cart.drink))  rows.push(rowItem("drink",obj));
      cartItemsEl.innerHTML = rows.join("") || `<p class="muted">Tu carrito estÃ¡ vacÃ­o.</p>`;
      cartTotalEl.textContent = money(calcTotal());
      const map={con_sazon:"Con sazÃ³n",sin_sazon:"Sin sazonar"};
      papasSummaryEl.textContent = cart.fries ? map[cart.fries] : "Sin elegir";
    }

    /*************** ACCIONES CARRITO ***************/
    async function addToCart(type,id,delta){
      const bucket = cart[type] || (cart[type]={});
      const current = bucket[id]?.qty || 0;
      const next = Math.max(0,current+delta);
      if(next===0) delete bucket[id];
      else bucket[id] = { qty: next, ...(bucket[id]||{}), item: bucket[id]?.item || findItem(type,id) };
      saveCart(); sync();
    }

    // Papas (obligatorio) en index para llevar la elecciÃ³n a la siguiente pÃ¡gina
    document.querySelectorAll('input[name="papas"]').forEach(r=>{
      r.addEventListener("change",()=>{
        cart.fries = r.value; saveCart(); sync();
      });
    });

    // Drawer
    const openDrawer = ()=> drawer.classList.add("open");
    const closeDrawer= ()=> drawer.classList.remove("open");
    $("#btnCarrito").onclick=openDrawer;
    $("#closeDrawer").onclick=closeDrawer;

    $("#btnVaciar").onclick=()=>{
      cart={burger:{},drink:{},fries:null}; saveCart(); sync();
    };

    // Finalizar -> redirige a pedido_cliente.html
    $("#btnFinalizar").onclick=()=>{
      if(cartCount()===0){ alert("AgregÃ¡ al menos un producto."); return; }
      if(!cart.fries){ alert("ElegÃ­ una opciÃ³n de papas (obligatorio)."); return; }
      window.location.href = "pedido_cliente.html";
    };

    // Contacto
    $("#btnContacto").onclick = ()=> window.location.href = "contacto.html";

    /*************** MODAL PERSONALIZAR ***************/
    const overlay = $("#overlay");
    const modTitle = $("#modTitle");
    const modQty   = $("#modQty");
    const modInc   = $("#modInc");
    const modDec   = $("#modDec");
    const modNotes = $("#modNotes");
    const modAdd   = $("#modAdd");
    const modCancel= $("#modCancel");
    let currentCustomize = null;

    function openCustomize(type,item){
      currentCustomize = { type, id:item.id, name:item.name };
      modTitle.textContent = "Personalizar: " + item.name;
      modQty.textContent = "1";
      modNotes.value = "";
      overlay.classList.add("open");
    }
    function closeCustomize(){ overlay.classList.remove("open"); }
    modInc.onclick = ()=> modQty.textContent = String(Math.min(99,(+modQty.textContent||1)+1));
    modDec.onclick = ()=> modQty.textContent = String(Math.max(1, (+modQty.textContent||1)-1));
    modCancel.onclick = closeCustomize;
    modAdd.onclick = ()=>{
      const qty = +modQty.textContent || 1;
      const notes = modNotes.value.trim();
      const t = currentCustomize.type; const id = currentCustomize.id;
      const item = (t==="burger"?BURGERS:DRINKS).find(x=>x.id===id);
      const bucket = cart[t] || (cart[t]={});
      const prev = bucket[id]?.qty || 0;
      bucket[id] = { qty: prev+qty, item, ...(notes?{notes}:{} ) };
      saveCart(); sync(); closeCustomize(); openDrawer();
    };

    // Init
    mount();
  </script>
</body>
</html>
