<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rhodes Burguers - Men√∫</title>
  <style>
    :root { --verde:#28a745; --negro:#333; }

    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding-top: 80px;
      background-image: url('background.jpg');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      background-attachment: fixed;
      background-color: #f0f0f0;
    }

    /* HEADER */
    header {
      background-color: white;
      color: black;
      position: fixed; top: 0; width: 100%;
      padding: 10px 24px;
      display: flex; justify-content: space-between; align-items: center;
      z-index: 20; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    header img.logo { height: 50px; }
    .header-right { display:flex; align-items:center; gap:12px; transform: translateX(-80px); }
    .btn {
      background: var(--verde); color: #fff; text-decoration: none;
      padding: 8px 16px; border-radius: 6px; font-weight: bold;
      border:2px solid #0f7a33;
    }

    /* Aviso ‚Äúsolo mirar‚Äù */
    .viewonly-banner{
      display:none; position:fixed; top:70px; left:50%; transform:translateX(-50%);
      background:#111; color:#fff; border:2px solid #10b981; padding:8px 12px;
      border-radius:10px; z-index:25; font-weight:700;
    }

    /* Secciones / tarjetas */
    h2 { text-align: center; margin: 18px 0; }
    .menu-section {
      margin: 24px auto 30px; max-width: 980px;
      background: rgba(255,255,255,0.95);
      border-radius: 12px; padding: 16px;
      box-shadow: 0 10px 26px rgba(0,0,0,0.15);
      border: 2px solid #000;
      position: relative;
    }

    /* Overlay CERRADO */
    .closed-overlay {
      position:absolute; inset:0;
      background: rgba(0,0,0,0.55);
      color:#fff; display:none; align-items:center; justify-content:center;
      border-radius: 12px; z-index:10; text-align:center; padding:16px;
    }
    .closed-box{
      background:#1f2937; border:2px solid #10b981; border-radius:12px;
      padding:16px 18px; box-shadow:0 10px 30px rgba(0,0,0,.35);
      max-width: 560px;
    }
    .closed-box h3{ margin:0 0 8px; }
    .closed-box p{ margin:6px 0; }
    .closed-box .countdown{ font-weight:800; margin-top:8px; }
    .closed-box .ghost-btn{
      margin-top:10px; background:transparent; color:#10b981;
      border:2px solid #10b981; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:800;
    }

    /* √çtems */
    .menu-item {
      display: grid;
      grid-template-columns: 140px 1fr auto auto auto;
      grid-template-areas: "img info price actions customize";
      gap: 14px; align-items: center;
      background: #fff; border-radius: 10px; padding: 12px; margin-bottom: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      border: 2px solid #000;
    }
    .item-img { grid-area: img; width: 140px; height: 100px; object-fit: cover; object-position: center; border-radius: 8px; background:#f4f4f4; border:1px solid #222; }
    .item-details { grid-area: info; min-width: 0; }
    .item-title { font-weight: 700; font-size: 1.05rem; color:#111; margin:0; }
    .item-desc { font-size: .9rem; color:#444; margin:.25rem 0 0; }
    .item-price { grid-area: price; font-weight: 700; min-width: 90px; text-align:right; }
    .item-actions { grid-area: actions; display:flex; align-items:center; gap: 8px; }
    input[type="number"] { width: 64px; padding:6px; border:1px solid #222; border-radius:6px; background:#fff; }
    button.add, button.customize { background:var(--negro); color:#fff; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; }
    button.customize { grid-area: customize; background:#0f7a33; }
    button:disabled{ opacity:.6; cursor:not-allowed; }

    /* PAPAS */
    .papas-opciones{ display:grid; gap:10px; max-width:520px; margin:0 auto; }
    .papas-item{ display:flex; align-items:center; gap:10px; background:#fff; border:2px solid #000; border-radius:10px; padding:12px; box-shadow:0 2px 6px rgba(0,0,0,0.08); }
    .papas-item label{ font-weight:700; cursor:pointer; }
    .papas-note{ text-align:center; margin-top:8px; color:#0b3e20; font-weight:700; }

    a#go-to-pedido {
      display:block; text-align:center; background:var(--verde); color:#fff;
      padding:12px; max-width:320px; margin: 6px auto 34px;
      text-decoration:none; border-radius: 8px; border:2px solid #0f7a33; font-weight: bold;
    }
    a#go-to-pedido.disabled{ opacity:.6; pointer-events:none; }

    /* Responsivo */
    @media (max-width: 900px) {
      .menu-item{
        grid-template-columns: 140px 1fr 180px;
        grid-template-areas:
          "img info price"
          "img info actions"
          "img info customize";
        align-items: start; gap: 12px 14px;
      }
      .item-img{ width:140px; height:100px; }
      .item-price{ justify-self: end; align-self: start; margin-top: 2px; font-size: 1.05rem; }
      .item-actions{ justify-self: end; }
      button.customize{ justify-self: end; }
    }
    @media (max-width: 720px) {
      .menu-item{
        grid-template-columns: 110px 1fr;
        grid-template-areas:
          "img info"
          "img price"
          "img actions"
          "img customize";
        align-items: start; gap: 10px 12px;
      }
      .item-img{ width:110px; height:90px; }
      .item-price{ justify-self: start; margin-top: 2px; font-size: 1rem; }
      .item-actions{ justify-self: start; }
      button.customize{ justify-self: start; width: auto; }
      input[type="number"]{ width:64px; padding:6px; }
    }

    /* MODAL */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.45); display: none; align-items: center; justify-content: center; z-index: 50; }
    .modal { width: 95%; max-width: 460px; background: #fff; border-radius: 12px; box-shadow: 0 16px 40px rgba(0,0,0,.25); border: 2px solid #000; padding: 16px; }
    .modal h3 { margin: 6px 0 10px; }
    .row { display:flex; align-items:center; justify-content:space-between; margin:10px 0; }
    .counter { display:flex; align-items:center; gap:8px; }
    .counter button { width:32px; height:32px; border-radius:6px; border:none; background:#333; color:#fff; cursor:pointer; }
    .pill { font-weight:700; }
    .modal .footer { display:flex; gap:8px; justify-content:flex-end; margin-top:14px; }
    .modal .footer button { padding:10px 14px; border-radius:8px; border:none; cursor:pointer; }
    .btn-cancel { background:#999; color:#fff; }
    .btn-apply { background:#28a745; color:#fff; }
    .modal .note { font-size: 0.9rem; color:#444; }
    .subtotal { font-weight: 700; margin-top: 6px; }
  </style>
</head>
<body>
  <header>
    <img src="logo.jpg" alt="Rhodes Burguers" class="logo">
    <div class="header-right">
      <a class="btn" href="contacto.html">Contacto</a>
    </div>
  </header>

  <div id="viewonlyBanner" class="viewonly-banner">üëÄ Est√°s en <strong>modo solo mirar</strong>. Para pedir, volv√© cuando abramos.</div>

  <section class="menu-section" id="hamburguesas">
    <div class="closed-overlay" id="overlay-hamb">
      <div class="closed-box">
        <h3>‚õî Cerrado ahora</h3>
        <p>Pr√≥xima apertura: <span id="next-open-1">‚Äî</span></p>
        <p class="countdown">Faltan: <span id="cd-1">‚Äî</span></p>
        <button id="viewonlyBtn" class="ghost-btn" type="button">Ver men√∫ (solo mirar)</button>
      </div>
    </div>
    <h2>Hamburguesas</h2>
  </section>

  <section class="menu-section" id="papas">
    <div class="closed-overlay" id="overlay-papas">
      <div class="closed-box">
        <h3>‚õî Cerrado ahora</h3>
        <p>Pr√≥xima apertura: <span id="next-open-2">‚Äî</span></p>
        <p class="countdown">Faltan: <span id="cd-2">‚Äî</span></p>
      </div>
    </div>
    <h2>Papas fritas (obligatorio)</h2>
    <div class="papas-opciones">
      <div class="papas-item">
        <input type="radio" name="fries" id="papas-sin" value="sin sazonar">
        <label for="papas-sin">Papas fritas sin sazonar</label>
      </div>
      <div class="papas-item">
        <input type="radio" name="fries" id="papas-con" value="con saz√≥n">
        <label for="papas-con">Papas fritas con saz√≥n</label>
      </div>
    </div>
    <div class="papas-note">Ten√©s que elegir una opci√≥n para continuar con el pedido.</div>
  </section>

  <section class="menu-section" id="bebidas">
    <div class="closed-overlay" id="overlay-beb">
      <div class="closed-box">
        <h3>‚õî Cerrado ahora</h3>
        <p>Pr√≥xima apertura: <span id="next-open-3">‚Äî</span></p>
        <p class="countdown">Faltan: <span id="cd-3">‚Äî</span></p>
      </div>
    </div>
    <h2>Bebidas</h2>
  </section>

  <a id="go-to-pedido" href="pedido_cliente.html">Ver mi pedido</a>

  <!-- Modal de personalizaci√≥n -->
  <div id="backdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal">
      <h3 id="modal-title">Personalizar</h3>
      <p class="note" id="modal-rules"></p>
      <div class="row" id="row-medallones" style="display:none;">
        <span><strong>Medallones extra</strong> <span class="pill">(+ $<span id="precio-medallon"></span> c/u)</span></span>
        <div class="counter">
          <button type="button" id="menos-medallon">-</button>
          <span id="cant-medallon">0</span>
          <button type="button" id="mas-medallon">+</button>
        </div>
      </div>
      <div class="row" id="row-cheddar">
        <span><strong>Fetas de cheddar extra</strong> <span class="pill">(+ $<span id="precio-cheddar"></span> c/u)</span></span>
        <div class="counter">
          <button type="button" id="menos-cheddar">-</button>
          <span id="cant-cheddar">0</span>
          <button type="button" id="mas-cheddar">+</button>
        </div>
      </div>
      <p class="subtotal">Extras: $<span id="subtotal-extras">0</span></p>
      <div class="footer">
        <button type="button" class="btn-cancel" id="cancelar">Cancelar</button>
        <button type="button" class="btn-apply" id="aplicar">A√±adir con extras</button>
      </div>
    </div>
  </div>

  <script>
    /* ======= Datos y render ======= */
    const PRECIO_EXTRA_MEDALLON = 2500;
    const PRECIO_EXTRA_CHEDDAR  = 700;

    const hamburguesas = [
      { nombre: "CheeseBurger Simple", tipo:"simple", desc: "Medall√≥n con doble cheddar en pan brioche. Incluye papas fritas.", precio: 9500,  imagen: "img/cheeseburger simple.jpg" },
      { nombre: "CheeseBurger Doble",  tipo:"doble",  desc: "Doble Medall√≥n con doble cheddar en pan brioche. Incluye papas fritas.",  precio: 12500, imagen: "img/cheeseburger doble.jpg" },
      { nombre: "CheeseBacon Simple",  tipo:"simple", desc: "Medall√≥n con doble cheddar y bacon en pan brioche. Incluye papas fritas.", precio: 10500, imagen: "img/cheesebacon simple.jpg" },
      { nombre: "CheeseBacon Doble",   tipo:"doble",  desc: "Doble Medall√≥n con doble cheddar y bacon en pan brioche. Incluye papas fritas.", precio: 13500, imagen: "img/cheesebacon doble.jpg" },
      { nombre: "Morgan Simple",        tipo:"simple", desc: "Doble cheddar, bacon, barbacoa y cebolla crispy. Incluye papas fritas.", precio: 10900, imagen: "img/Morgan Simple.jpg" },
      { nombre: "Morgan Doble",         tipo:"doble",  desc: "Doble medall√≥n, doble cheddar, bacon, barbacoa y cebolla crispy. Incluye papas fritas.", precio: 14500, imagen: "img/Morgan Doble.jpg" },
      { nombre: "Big John Simple",      tipo:"simple", desc: "Cheddar, lechuga, pepinillos y salsa big mac. Incluye papas fritas.", precio: 10900, imagen: "img/Big John Simple.jpg" },
      { nombre: "Big John Doble",       tipo:"doble",  desc: "Doble medall√≥n, cheddar, lechuga, pepinillos y salsa big mac. Incluye papas fritas.", precio: 13900, imagen: "img/Big John Doble.jpg" },
      { nombre: "Rhodes Simple",        tipo:"simple", desc: "Doble cheddar, bacon, morrones, cebolla y salsa crispy. Incluye papas fritas.", precio: 11900, imagen: "img/Rhodes Simple.jpg" },
      { nombre: "Rhodes Doble",         tipo:"doble",  desc: "Doble medall√≥n, cheddar, bacon, morrones, cebolla y salsa crispy. Incluye papas fritas.", precio: 14900, imagen: "img/Rhodes Doble.jpg" },
      { nombre: "Burguesa Simple",      tipo:"simple", desc: "Doble cheddar, mostaza y miel, cebolla caramelizada (pan Burgerluna). Incluye papas fritas.", precio: 11900, imagen: "img/Burguesa Simple.jpg" },
      { nombre: "Burguesa Doble",       tipo:"doble",  desc: "Doble medall√≥n, doble cheddar, mostaza y miel, cebolla caramelizada (pan Burgerluna). Incluye papas fritas.", precio: 14900, imagen: "img/Burguesa Doble.jpg" },
      { nombre: "Pollo Crispy",         tipo:"pollo",  desc: "Pechuga crispy con lechuga y mayo en pan brioche. Incluye papas fritas.", precio: 8900,  imagen: "img/Pollo crispy.jpg" }
    ];
    const bebidas = [
      { nombre: "Coca Cola Original 500cc", desc: "", precio: 3000, imagen: "img/coca cola original.jpg", tipo: "bebida" },
      { nombre: "Coca Cola Zero 500cc",     desc: "", precio: 3000, imagen: "img/coca cola zero.jpg",     tipo: "bebida" },
      { nombre: "Sprite 500cc",             desc: "", precio: 3000, imagen: "img/sprite.jpg",             tipo: "bebida" },
      { nombre: "Aquarius Pera 500cc",      desc: "", precio: 3000, imagen: "img/aquarius pera.jpg",      tipo: "bebida" },
      { nombre: "Aquarius Pomelo 500cc",    desc: "", precio: 3000, imagen: "img/aquarius pomelo.jpg",    tipo: "bebida" }
    ];

    function el(tag, cls) { const e=document.createElement(tag); if(cls) e.className=cls; return e; }

    function renderItems(items, containerId) {
      const container = document.getElementById(containerId);
      const overlay = container.querySelector('.closed-overlay')?.outerHTML || '';
      const titleText = container.querySelector('h2')?.textContent || '';
      container.innerHTML = overlay + `<h2>${titleText}</h2>`;

      items.forEach(({ nombre, desc, precio, imagen, tipo }) => {
        const card = el("div","menu-item");

        const img = el("img","item-img"); if (imagen) img.src = imagen; img.alt = nombre; card.appendChild(img);
        const details = el("div","item-details"); details.innerHTML = `<h3 class="item-title">${nombre}</h3>${desc ? `<p class="item-desc">${desc}</p>` : ''}`; card.appendChild(details);
        const price = el("div","item-price"); price.textContent = `$${precio}`; card.appendChild(price);

        const actions = el("div","item-actions");
        const qty = el("input"); qty.type="number"; qty.min="1"; qty.value="1";
        const add = el("button","add"); add.textContent = "A√±adir";
        add.addEventListener("click", () => agregarPedidoBasico(nombre, precio, desc||'', qty));
        actions.appendChild(qty); actions.appendChild(add);
        card.appendChild(actions);

        if (tipo !== "bebida") {
          const customize = el("button","customize"); customize.textContent="Personalizar";
          customize.addEventListener("click", () => abrirModalPersonalizar({ nombre, tipo, basePrecio: precio, desc: desc||'', qtyInput: qty }));
          card.appendChild(customize);
        }
        container.appendChild(card);
      });
    }

    function agregarPedidoBasico(nombre, precio, desc, qtyInput) {
      if (!isOpenNow()) { showClosedAlert(); return; }
      const cantidad = Math.max(1, parseInt(qtyInput.value || '1', 10));
      const itemKey = desc ? `${nombre} - ${desc}` : nombre;
      const pedido = JSON.parse(localStorage.getItem('order') || '[]');
      const existente = pedido.find(p => p.item === itemKey);
      if (existente) existente.quantity += cantidad;
      else pedido.push({ item: itemKey, quantity: cantidad, price: precio });
      localStorage.setItem('order', JSON.stringify(pedido));
      qtyInput.value = 1;
      alert(`${cantidad} x ${nombre} a√±adido al pedido`);
    }

    renderItems(hamburguesas, 'hamburguesas');
    renderItems(bebidas, 'bebidas');

    /* ======= Modal ======= */
    const backdrop = document.getElementById('backdrop');
    const precioMedallonEl = document.getElementById('precio-medallon');
    const precioCheddarEl  = document.getElementById('precio-cheddar');
    const cantMedallonEl = document.getElementById('cant-medallon');
    const cantCheddarEl  = document.getElementById('cant-cheddar');
    const rowMedallones  = document.getElementById('row-medallones');
    const rowCheddar     = document.getElementById('row-cheddar');
    const menosMedallon  = document.getElementById('menos-medallon');
    const masMedallon    = document.getElementById('mas-medallon');
    const menosCheddar   = document.getElementById('menos-cheddar');
    const masCheddar     = document.getElementById('mas-cheddar');
    const subtotalExtrasEl = document.getElementById('subtotal-extras');
    const cancelarBtn    = document.getElementById('cancelar');
    const aplicarBtn     = document.getElementById('aplicar');
    const modalRulesEl   = document.getElementById('modal-rules');
    precioMedallonEl.textContent = PRECIO_EXTRA_MEDALLON;
    precioCheddarEl.textContent  = PRECIO_EXTRA_CHEDDAR;

    let modalState = null;

    function abrirModalPersonalizar({ nombre, tipo, basePrecio, desc, qtyInput }) {
      if (!isOpenNow()) { showClosedAlert(); return; }
      let maxMed = 0;
      let maxCheddar = 3;
      if (tipo === 'doble') maxMed = 2;

      const parts = [];
      if (maxMed > 0) parts.push(`hasta ${maxMed} medallones extra`);
      if (maxCheddar > 0) parts.push(`hasta ${maxCheddar} fetas de cheddar extra`);
      modalRulesEl.textContent = `Pod√©s agregar ${parts.join(' y ')}.`;

      rowMedallones.style.display = maxMed > 0 ? 'flex' : 'none';
      rowCheddar.style.display = 'flex';

      cantMedallonEl.textContent = '0';
      cantCheddarEl.textContent  = '0';
      subtotalExtrasEl.textContent = '0';

      modalState = { nombre, tipo, basePrecio, desc, qtyInput, maxMed, maxCheddar, med:0, cheddar:0 };
      backdrop.style.display = 'flex';
    }
    function actualizarSubtotal() {
      const extras = (modalState.med * PRECIO_EXTRA_MEDALLON) + (modalState.cheddar * PRECIO_EXTRA_CHEDDAR);
      subtotalExtrasEl.textContent = extras.toString();
    }
    masMedallon.addEventListener('click', () => { if (!modalState) return; if (modalState.med < modalState.maxMed) { modalState.med++; cantMedallonEl.textContent = modalState.med; actualizarSubtotal(); } });
    menosMedallon.addEventListener('click', () => { if (!modalState) return; if (modalState.med > 0) { modalState.med--; cantMedallonEl.textContent = modalState.med; actualizarSubtotal(); } });
    masCheddar.addEventListener('click', () => { if (!modalState) return; if (modalState.cheddar < modalState.maxCheddar) { modalState.cheddar++; cantCheddarEl.textContent = modalState.cheddar; actualizarSubtotal(); } });
    menosCheddar.addEventListener('click', () => { if (!modalState) return; if (modalState.cheddar > 0) { modalState.cheddar--; cantCheddarEl.textContent = modalState.cheddar; actualizarSubtotal(); } });
    cancelarBtn.addEventListener('click', () => { backdrop.style.display = 'none'; modalState = null; });

    aplicarBtn.addEventListener('click', () => {
      if (!modalState) return;
      const { nombre, basePrecio, desc, qtyInput, med, cheddar } = modalState;
      const cantidad = Math.max(1, parseInt(qtyInput.value || '1', 10));
      const extrasPrecio = (med * PRECIO_EXTRA_MEDALLON) + (cheddar * PRECIO_EXTRA_CHEDDAR);
      const precioFinal = basePrecio + extrasPrecio;

      let extrasDesc = [];
      if (med > 0) extrasDesc.push(`+${med} medall√≥n/es`);
      if (cheddar > 0) extrasDesc.push(`+${cheddar} cheddar`);
      const itemText = extrasDesc.length
        ? `${nombre} - ${desc}${desc ? ' - ' : ''}Extras: ${extrasDesc.join(', ')}`
        : (desc ? `${nombre} - ${desc}` : nombre);

      const pedido = JSON.parse(localStorage.getItem('order') || '[]');
      const existente = pedido.find(p => p.item === itemText);
      if (existente) existente.quantity += cantidad;
      else pedido.push({ item: itemText, quantity: cantidad, price: precioFinal });

      localStorage.setItem('order', JSON.stringify(pedido));
      qtyInput.value = 1;
      backdrop.style.display = 'none';
      modalState = null;
      alert(`${cantidad} x ${nombre} (con extras) a√±adido al pedido`);
    });

    backdrop.addEventListener('click', (e) => { if (e.target === backdrop) { backdrop.style.display = 'none'; modalState = null; } });

    /* PAPAS OBLIGATORIAS + Ver mi pedido */
    document.addEventListener('DOMContentLoaded', () => {
      const saved = localStorage.getItem('friesChoice');
      if (saved === 'sin sazonar') document.getElementById('papas-sin').checked = true;
      if (saved === 'con saz√≥n')   document.getElementById('papas-con').checked = true;
    });
    document.getElementById('go-to-pedido').addEventListener('click', (e) => {
      if (!isOpenNow()) { e.preventDefault(); showClosedAlert(); return; }
      const sin = document.getElementById('papas-sin')?.checked;
      const con = document.getElementById('papas-con')?.checked;
      if (!sin && !con) {
        e.preventDefault();
        alert('Eleg√≠ una opci√≥n de papas fritas para continuar.');
        document.getElementById('papas').scrollIntoView({ behavior: 'smooth', block: 'center' });
        return;
      }
      const choice = sin ? 'sin sazonar' : 'con saz√≥n';
      localStorage.setItem('friesChoice', choice);

      let pedido = JSON.parse(localStorage.getItem('order') || '[]');
      const key = `Papas fritas (${choice})`;
      const otraKey = `Papas fritas (${sin ? 'con saz√≥n' : 'sin sazonar'})`;
      pedido = pedido.filter(p => p.item !== otraKey);
      const existente = pedido.find(p => p.item === key);
      if (!existente) pedido.push({ item: key, quantity: 1, price: 0 });
      localStorage.setItem('order', JSON.stringify(pedido));
    });

    /* ====== HORARIOS (CERRADO/ABIERTO) + COUNTDOWN + SOLO MIRAR ====== */
    const SCHEDULE = {
      0: [{start:"19:00", end:"23:00"}],                                  // Domingo
      1: [],                                                              // Lunes
      2: [],                                                              // Martes
      3: [{start:"19:00", end:"23:30"}],                                  // Mi√©rcoles
      4: [{start:"19:00", end:"23:30"}],                                  // Jueves
      5: [{start:"12:00", end:"15:00"}, {start:"19:00", end:"23:30"}],    // Viernes
      6: [{start:"12:00", end:"15:00"}, {start:"19:00", end:"23:30"}],    // S√°bado
    };
    const toMin = t => { const [h,m]=t.split(':').map(Number); return h*60+m; };
    function isOpenNow(d=new Date()){
      const day = d.getDay(); const mins = d.getHours()*60 + d.getMinutes();
      const ranges = SCHEDULE[day] || [];
      return ranges.some(r => mins >= toMin(r.start) && mins < toMin(r.end));
    }
    function nextOpeningObj(from=new Date()){
      for (let i=0;i<8;i++){
        const base = new Date(from.getFullYear(), from.getMonth(), from.getDate()+i, 0,0,0,0);
        const ranges = SCHEDULE[base.getDay()]||[];
        if (!ranges.length) continue;
        if (i>0){
          const [h,m] = ranges[0].start.split(':').map(Number);
          const dt = new Date(base.getFullYear(), base.getMonth(), base.getDate(), h, m, 0, 0);
          return dt;
        }
        // hoy
        const nowMins = from.getHours()*60 + from.getMinutes();
        const next = ranges.find(r => nowMins < toMin(r.start));
        if (next){
          const [h,m] = next.start.split(':').map(Number);
          const dt = new Date(base.getFullYear(), base.getMonth(), base.getDate(), h, m, 0, 0);
          return dt;
        }
      }
      return null;
    }
    const fmtDate = d => d.toLocaleDateString(undefined,{weekday:'long', day:'2-digit', month:'2-digit'});
    const two = n => String(n).padStart(2,'0');

    let viewOnly = false;

    function showClosedAlert(){
      const nx = nextOpeningObj();
      const msg = nx
        ? `Estamos cerrados ahora. Pr√≥xima apertura: ${fmtDate(nx)} ${two(nx.getHours())}:${two(nx.getMinutes())}hs.`
        : `Estamos cerrados ahora.`;
      alert(msg);
    }

    function setButtonsEnabled(enabled){
      document.querySelectorAll('button.add, button.customize').forEach(b => b.disabled = !enabled);
      const go = document.getElementById('go-to-pedido');
      if (enabled) go.classList.remove('disabled'); else go.classList.add('disabled');
    }

    function applyOpenState(){
      const abierto = isOpenNow();
      const overlays = [
        {el:document.getElementById('overlay-hamb'), p:document.getElementById('next-open-1'), cd:document.getElementById('cd-1')},
        {el:document.getElementById('overlay-papas'), p:document.getElementById('next-open-2'), cd:document.getElementById('cd-2')},
        {el:document.getElementById('overlay-beb'),  p:document.getElementById('next-open-3'), cd:document.getElementById('cd-3')}
      ];
      const banner = document.getElementById('viewonlyBanner');

      if (abierto){
        // abierto normal
        overlays.forEach(o=>{ if(o.el) o.el.style.display='none'; });
        banner.style.display='none';
        viewOnly = false;
        setButtonsEnabled(true);
      }else{
        const nx = nextOpeningObj();
        const text = nx ? `${fmtDate(nx)} ${two(nx.getHours())}:${two(nx.getMinutes())}hs` : '‚Äî';
        overlays.forEach(o=>{
          if (!o.el) return;
          if (!viewOnly){
            o.el.style.display='flex';
          }else{
            o.el.style.display='none';
          }
          if (o.p) o.p.textContent = text;
        });
        // en cerrado: si solo mirar => botones deshabilitados pero sin overlay
        setButtonsEnabled(false);
        banner.style.display = viewOnly ? 'block' : 'none';
      }
    }

    // COUNTDOWN cada 1s
    function tickCountdown(){
      const nx = nextOpeningObj();
      const ids = ['cd-1','cd-2','cd-3'];
      if (!nx){
        ids.forEach(id=>{ const el=document.getElementById(id); if(el) el.textContent='‚Äî'; });
        return;
      }
      const now = new Date();
      const diff = Math.max(0, nx.getTime()-now.getTime());
      const s = Math.floor(diff/1000);
      const d = Math.floor(s/86400);
      const h = Math.floor((s%86400)/3600);
      const m = Math.floor((s%3600)/60);
      const ss= Math.floor(s%60);
      const str = (d>0? d+'d ':'') + `${two(h)}:${two(m)}:${two(ss)}`;
      ids.forEach(id=>{ const el=document.getElementById(id); if(el) el.textContent=str; });
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      // bot√≥n ‚Äúsolo mirar‚Äù
      const vo = document.getElementById('viewonlyBtn');
      if (vo){
        vo.addEventListener('click', ()=>{
          viewOnly = true;
          applyOpenState();
        });
      }
      applyOpenState();
      setInterval(applyOpenState, 60000);
      tickCountdown();
      setInterval(tickCountdown, 1000);
    });
  </script>
</body>
</html>
