<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>¡Gracias! • Rhodes Burgers</title>
  <link rel="icon" href="images/logo.png" />
  <style>
    :root{
      --primary:#625A45; --text:#111; --muted:#666; --bg:#f6f6f6; --card:#fff;
      --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.08); --ring:#eaeaea;
      --st-accepted:#FBC02D; --st-preparing:#FB8C00; --st-ready:#00ACC1; --st-completed:#2E7D32; --st-cancelled:#D32F2F;
      --pay-pending:#FFA000; --pay-paid:#625A45;
      --star-off:#DDD; --star-on:#F5A524;
    }

    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif}
    header{position:sticky;top:0;z-index:10;background:#fff;box-shadow:0 2px 12px rgba(0,0,0,.06)}

    .topbar{max-width:1100px;margin:0 auto;padding:10px 12px;display:flex;align-items:center;gap:12px}
    .brand{display:flex;align-items:center;text-decoration:none;color:inherit;font-weight:700}
    .brand img{width:36px;height:36px;border-radius:10px;background:#fff;object-fit:contain;margin-right:8px}
    .spacer{flex:1}
    .btn{display:inline-flex;align-items:center;gap:8px;border:2px solid var(--primary);background:#fff;color:var(--primary);padding:10px 16px;border-radius:999px;font-weight:700;cursor:pointer;text-decoration:none}
    .btn.primary{background:var(--primary);color:#fff}
    .btn.ghost{border-color:#e7e7e7;color:#333}
    .btn[disabled]{opacity:.6;cursor:not-allowed}

    main{max-width:1100px;margin:24px auto;padding:0 12px;display:grid;grid-template-columns:1fr 420px;gap:18px}
    @media (max-width:900px){ main{grid-template-columns:1fr} }

    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;overflow:visible}
    h1{font-size:28px;margin:10px 0 8px}
    h2{font-size:18px;margin:10px 0}
    .muted{color:var(--muted)}
    .row{display:flex;align-items:center;justify-content:space-between;margin:8px 0;gap:12px;flex-wrap:wrap}
    .total{font-weight:800;font-size:18px}

    .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1.5px solid var(--ring);font-weight:800;background:#fff}
    .badge.accepted{border-color:var(--st-accepted);color:var(--st-accepted)}
    .badge.preparing{border-color:var(--st-preparing);color:var(--st-preparing)}
    .badge.ready_for_pickup{border-color:var(--st-ready);color:var(--st-ready)}
    .badge.completed{border-color:var(--st-completed);color:var(--st-completed)}
    .badge.cancelled{border-color:var(--st-cancelled);color:var(--st-cancelled)}

    .steps{display:grid;grid-template-columns:repeat(auto-fit,minmax(132px,1fr));gap:10px;margin-top:12px}
    .step{padding:12px;border:1.5px solid var(--ring);border-radius:14px;text-align:center;font-size:14px;background:#fff;color:#333;font-weight:700;min-height:46px;overflow-wrap:anywhere;transition:background .15s,color .15s,border-color .15s}
    .step.fill-accepted{background:var(--st-accepted);border-color:var(--st-accepted);color:#000}
    .step.fill-preparing{background:var(--st-preparing);border-color:var(--st-preparing);color:#fff}
    .step.fill-ready_for_pickup{background:var(--st-ready);border-color:var(--st-ready);color:#fff}
    .step.fill-completed{background:var(--st-completed);border-color:var(--st-completed);color:#fff}
    .step.fill-cancelled{background:var(--st-cancelled);border-color:var(--st-cancelled);color:#fff}

    .small{font-size:13px}
    .error{color:#b00020}
    .success{color:#2E7D32;font-weight:700}
    .items .line{display:flex;align-items:flex-start;justify-content:space-between;margin:10px 0;gap:12px}
    .items .muted{font-size:13px}
    .pay-pill{display:inline-block;border-radius:999px;padding:8px 12px;font-weight:800;font-size:13px;color:#fff}
    .pay-paid{background:var(--pay-paid)}
    .pay-pending{background:var(--pay-pending)}
    .meta{display:flex;gap:8px;flex-wrap:wrap}

    /* Comentarios */
    .textarea{
      width:100%;min-height:96px;max-height:220px;padding:12px 14px;
      border:1px solid var(--ring);border-radius:14px;background:#faf9f7;
      resize:vertical;font-size:15px;line-height:1.35;
      transition:border-color .15s ease,box-shadow .15s ease,background .15s ease;
      margin-top:16px;
    }
    .textarea::placeholder{color:#9a9a9a}
    .textarea:focus{outline:0;background:#fff;border-color:var(--primary);box-shadow:0 0 0 3px rgba(98,90,69,.18)}
    .field-foot{display:flex;justify-content:space-between;align-items:center;margin-top:6px;font-size:12px;color:#8a8a8a}
    .right-actions{display:flex;gap:8px;align-items:center}
    .bordered{border:1.5px solid var(--ring);padding:12px;border-radius:12px;background:#fff}

    /* Estrellas */
    .rating-wrap{display:flex;align-items:flex-start;gap:14px;flex-wrap:wrap}
    .stars{display:inline-flex;gap:10px;margin-bottom:4px;user-select:none}
    .star{
      -webkit-appearance:none;appearance:none;border:0;background:none;margin:0;
      cursor:pointer;font-size:40px;line-height:1;color:var(--star-off);
      transition:color .12s ease,transform .06s ease;
      width:42px;height:42px;display:flex;align-items:center;justify-content:center;
      border-radius:8px;-webkit-tap-highlight-color:transparent;
    }
    .star.on{color:var(--star-on)!important;}
    .star:hover,.star.preview{color:var(--star-on)!important;}
    .star:active{transform:scale(.92)}
    .star:focus{outline:3px solid rgba(98,90,69,.35)}

    html,body{min-height:100%}
    body::before{
      content:"";position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
      width:clamp(240px,48vmin,560px);background:url("images/logo.png") center/contain no-repeat;
      opacity:.08;pointer-events:none;z-index:5;
    }
  </style>
</head>
<body>
  <header>
    <div class="topbar">
      <a class="brand" href="index.html"><img src="images/logo.png" alt="">Rhodes Burgers</a>
      <div class="spacer"></div>
      <a class="btn ghost" href="index.html">Volver al menú</a>
    </div>
  </header>

  <main>
    <section class="card">
      <h1>¡Gracias por tu pedido! <span id="greet" class="muted"></span></h1>
      <div class="row">
        <div id="badge" class="badge">Estado: —</div>
        <div id="num" class="muted">#—</div>
      </div>

      <div class="steps">
        <div class="step" id="st-pending_payment">Pago pendiente</div>
        <div class="step" id="st-accepted">Recibido</div>
        <div class="step" id="st-preparing">Preparando</div>
        <div class="step" id="st-ready_for_pickup">Listo para retirar</div>
        <div class="step" id="st-completed">Entregado</div>
      </div>

      <div style="margin-top:12px" class="small muted meta">
        <span>Última actualización: <span id="time">—</span></span>
        <span>•</span>
        <span>Forma de pago: <span id="pay">—</span></span>
        <span>•</span>
        <span>Entrega: <span id="deliv">—</span></span>
      </div>

      <div id="info" class="small muted" style="margin-top:8px">Cargando estado…</div>
    </section>

    <aside class="card">
      <h2>Tu pedido</h2>
      <div id="items" class="items"></div>
      <div class="row total"><div>Total</div><div id="resTotal">$ 0</div></div>
      <div style="margin-top:6px"><span id="payPill" class="pay-pill pay-pending">PENDIENTE DE PAGO</span></div>
      <div class="small muted" style="margin-top:10px">Si necesitás modificar algo, escribinos por WhatsApp con tu número de pedido.</div>
    </aside>

    <!-- Comentarios + rating -->
    <section class="card">
      <h2>Dejanos tu comentario</h2>
      <div class="bordered">
        <div class="rating-wrap">
          <div class="stars" id="ratingStars" role="radiogroup" aria-label="Calificación de 1 a 5">
            <button type="button" class="star" data-val="1" aria-label="1 estrella">★</button>
            <button type="button" class="star" data-val="2" aria-label="2 estrellas">★</button>
            <button type="button" class="star" data-val="3" aria-label="3 estrellas">★</button>
            <button type="button" class="star" data-val="4" aria-label="4 estrellas">★</button>
            <button type="button" class="star" data-val="5" aria-label="5 estrellas">★</button>
          </div>
        </div>

        <textarea id="fbText" class="textarea" maxlength="300" placeholder="¿Cómo estuvo tu experiencia? (máx. 300 caracteres)"></textarea>
        <div class="field-foot">
          <span id="fbCount">0/300</span>
          <div class="right-actions"><button id="btnSendFb" class="btn primary">Enviar</button></div>
        </div>
        <div id="fbMsg" class="small muted" style="margin-top:6px"></div>
      </div>
    </section>
  </main>

  <script>
    // ======== Estrellas funcionales ========
    let currentRating = 0;
    const stars = Array.from(document.querySelectorAll("#ratingStars .star"));
    const fbText = () => document.getElementById("fbText");
    const fbCount = () => document.getElementById("fbCount");

    function paintStars(n, preview=false){
      stars.forEach(btn=>{
        const v = Number(btn.dataset.val);
        btn.classList.toggle("on", v <= n);
        btn.classList.toggle("preview", preview && v <= n);
      });
    }

    function setRating(n){
      currentRating = n;
      paintStars(n,false);
    }

    stars.forEach(btn=>{
      const v = Number(btn.dataset.val);
      btn.addEventListener("mouseenter", ()=>paintStars(v,true));
      btn.addEventListener("mouseleave", ()=>paintStars(currentRating,false));
      btn.addEventListener("click", ()=>setRating(v));
    });

    if(fbText()){
      fbText().addEventListener("input", ()=>{
        fbCount().textContent = `${fbText().value.length}/300`;
      });
    }

    paintStars(0,false);
  </script>
</body>
</html>
