<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mi Pedido - Hamburguesería Rhodes</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; color: #333; }
    header { text-align: center; padding: 2rem 1rem; background-color: #343a40; color: white; }
    main { max-width: 600px; margin: 2rem auto; background-color: white; border-radius: 12px; padding: 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
    h2 { margin-bottom: 1.5rem; color: #2c3e50; }
    .form-section { margin-bottom: 1.2rem; }
    label { display: block; font-weight: bold; margin-bottom: 0.5rem; }
    input, select, textarea { width: 100%; padding: 0.6rem; font-size: 1rem; border-radius: 8px; border: 1px solid #ccc; }
    ul { padding-left: 1.2rem; margin-top: 1rem; }
    li { margin-bottom: 0.5rem; }
    button { margin-top: 1.5rem; padding: 0.75rem 1.2rem; font-size: 1rem; background-color: #28a745; color: white;
              border: none; border-radius: 8px; cursor: pointer; }
    button:hover { background-color: #218838; }
  </style>
</head>
<body>
  <header><h1>Tu pedido</h1></header>
  <main>
    <h2>Resumen de tu pedido</h2>
    <ul id="resumen-pedido"></ul>
    <div class="form-section">
      <label for="cliente-nombre">Nombre y apellido:</label>
      <input type="text" id="cliente-nombre" required />
    </div>
    <div class="form-section">
      <label for="metodo-pago">Método de pago:</label>
      <select id="metodo-pago" required>
        <option value="">Seleccionar</option>
        <option value="efectivo">Efectivo</option>
        <option value="debito">Débito</option>
        <option value="mercado-pago">Mercado Pago</option>
      </select>
    </div>
    <div class="form-section">
      <label for="tipo-entrega">Tipo de pedido:</label>
      <select id="tipo-entrega" required>
        <option value="">Seleccionar</option>
        <option value="delivery">Delivery</option>
        <option value="takeaway">Take Away</option>
      </select>
    </div>
    <div class="form-section">
      <label for="comentarios">Comentarios adicionales:</label>
      <textarea id="comentarios" rows="3"></textarea>
    </div>
    <button id="confirmar-pedido">Confirmar pedido</button>
  </main>

  <script type="module">
    
<!-- Firebase SDKs -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBbt5YOWDE0ouLn-Ib_iD1yUesok5SEhB8",
    authDomain: "rhodes-burguers.firebaseapp.com",
    projectId: "rhodes-burguers",
    storageBucket: "rhodes-burguers.firebasestorage.app",
    messagingSenderId: "951646688091",
    appId: "1:951646688091:web:05db5fadb4150d1fa9c07e",
    measurementId: "G-LQVYTJWHSM"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

    const resumenLista = document.getElementById("resumen-pedido");
    const pedido = JSON.parse(localStorage.getItem("pedidoClienteActual")) || [];

    if (pedido.length === 0) resumenLista.innerHTML = "<li>No hay productos en tu pedido.</li>";
    else pedido.forEach(item => { resumenLista.innerHTML += `<li>${item.quantity} x ${item.item}</li>`; });

    document.getElementById("confirmar-pedido").addEventListener("click", async () => {
      const nombre = document.getElementById("cliente-nombre").value.trim();
      const metodoPago = document.getElementById("metodo-pago").value;
      const tipoEntrega = document.getElementById("tipo-entrega").value;
      const comentarios = document.getElementById("comentarios").value.trim();

      if (!nombre || !metodoPago || !tipoEntrega) {
        alert("Por favor completá todos los campos.");
        return;
      }

      const pedidoData = {
        cliente: nombre,
        metodoPago,
        tipoEntrega,
        comentarios,
        pedido,
        fecha: new Date().toISOString()
      };

      try {
        await addDoc(collection(db, "pedidos"), pedidoData);
        alert("¡Pedido enviado con éxito!");
        localStorage.removeItem("pedidoClienteActual");
        window.location.href = "index.html";
      } catch (e) {
        console.error("Error al enviar pedido: ", e);
        alert("Hubo un error al enviar el pedido.");
      }
    });
  </script>
</body>
</html>